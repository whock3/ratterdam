p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod3 <- lmer(rate ~ dFactor:ns(cFactor,3)+(1+dFactor|rat), data=df)
df$fit <- predict(mod3, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor:ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod3) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod2 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1|rat), data=df)
df$fit <- predict(mod2, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor:ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod2) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod2 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1|rat), data=df)
df$fit <- predict(mod2, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod2) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
modg <- glmer(rate+10 ~ dFactor:ns(cFactor,3)+(1+dFactor|rat)+(1+cFactor|rat),
family=Gamma,
data = df,
control = glmerControl(optimizer='Nelder_Mead'),
nAGQ=0
)
Designmat <- model.matrix(rate ~ dFactor:ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(modg) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
# hist of rates
p <- ggplot(df,aes(x=rate))+
geom_histogram()
print(p)
(prelim_plot <- ggplot(df, aes(x = cFactor, y = rate)) +
geom_point(alpha=0.5) +
geom_smooth(method = "lm"))
print(prelim_plot)
boxplot(rate~dFactor,data=df)
# overall colored by rat / factor
(colour_plot <- ggplot(df, aes(x = cFactor, y = rate, colour = as.factor(rat))) +
geom_point(size = 2))
(colour_plot <- ggplot(df, aes(x = cFactor, y = rate, colour = as.factor(dFactor))) +
geom_point(size = 2))
basic_c_LM <- lm(rate ~ cFactor, data=df)
basic_d_LM <- lm(rate ~ dFactor, data=df)
plot(basic_c_LM,which=1)
plot(basic_c_LM,which=2)
plot(basic_d_LM,which=1)
plot(basic_d_LM,which=2)
boxplot(rate~rat,data=df)
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(rat)))+
geom_point(aes(cFactor, fit))
print(p)
# plot by rat
facets <- ggplot(aes(cFactor, rate), data=df)+
geom_point()+
facet_wrap(~rat)
print(facets)
mod6 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1+dFactor|rat)+(1+cFactor|rat), data=df)
df$fit <- predict(mod6, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor:ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod6) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod6 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1+dFactor|rat)+(1+cFactor|rat), data=df)
df$fit <- predict(mod6, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod6) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod6 <- lmer(rate ~ dFactor:ns(cFactor,3)+(1+dFactor|rat)+(1+cFactor|rat), data=df)
df$fit <- predict(mod6, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor:ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod6) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod6 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1+dFactor|rat)+(1+cFactor|rat), data=df)
df$fit <- predict(mod6, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod6) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
# GLMER mode
mod2 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1|rat), data=df)
df$fit <- predict(mod2, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod2) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod3 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1+dFactor|rat), data=df)
df$fit <- predict(mod3, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod3) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod4a <- lmer(rate ~ dFactor*cFactor+(1+ns(cFactor,3)|rat), data=df)
df$fit <- predict(mod4a, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*cFactor, df)
predvar <- diag(Designmat %*% vcov(mod4a) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod5 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1+cFactor|rat)+ (1+dFactor|rat), data=df)
df$fit <- predict(mod5, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod5) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
(mm_plot <- ggplot(df, aes(x = cFactor, y = rate, colour = as.factor(dFactor))) +
facet_wrap(~rat, nrow=2) +   # a panel for each mountain range
geom_point(alpha = 0.5) +
theme_classic() +
geom_line(data = cbind(df, pred = predict(mod6)), aes(y = pred), size = 1) +  # adding predicted line from mixed model
theme(legend.position = "none",
panel.spacing = unit(2, "lines"))  # adding space between panels
)
print(mm_plot)
source('~/GitHub/ratterdam/labMeetingLMERScript.R')
# model 5
mod5 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1+cFactor|rat)+ (1+dFactor|rat), data=df)
df$fit <- predict(mod5, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor:ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod5) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
# model 5
mod5 <- lmer(rate ~ dFactor:ns(cFactor,3)+(1+cFactor|rat)+ (1+dFactor|rat), data=df)
df$fit <- predict(mod5, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor:ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod5) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod5 <- lmer(rate ~ dFactor:ns(cFactor,3)+(1+ns(cFactor,3)|rat)+ (1+dFactor|rat), data=df)
df$fit <- predict(mod5, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor:ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod5) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod5 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1+ns(cFactor,3)|rat)+ (1+dFactor|rat), data=df)
df$fit <- predict(mod5, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod5) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
# model 3
mod3 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1+dFactor|rat), data=df)
df$fit <- predict(mod3, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod3) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
source('~/GitHub/ratterdam/labMeetingLMERScript.R')
mod6 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1+dFactor|rat)+(1+cFactor|rat), data=df)
df$fit <- predict(mod6, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod6) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod6 <- lmer(rate ~ dFactor+ns(cFactor,3)+(1+dFactor|rat)+(1+cFactor|rat), data=df)
df$fit <- predict(mod6, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor+ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod6) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod6 <- lmer(rate ~ dFactor:ns(cFactor,3)+(1+dFactor|rat)+(1+cFactor|rat), data=df)
df$fit <- predict(mod6, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor:ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod6) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
source('~/GitHub/ratterdam/labMeetingLMERScript.R')
mod6 <- lmer(rate ~ dFactor:ns(cFactor,3)+(1+dFactor|rat)+(1+cFactor|rat), data=df)
df$fit <- predict(mod6, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor:ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod6) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod1 <- lm(rate ~ dFactor:cFactor, data=df)
df$fit <- predict(mod1, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor:cFactor, df)
predvar <- diag(Designmat %*% vcov(mod1) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod2 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1|rat), data=df)
df$fit <- predict(mod2, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod2) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod3 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1+dFactor|rat), data=df)
df$fit <- predict(mod3, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod3) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod4 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1+cFactor|rat), data=df)
df$fit <- predict(mod4, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod4) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
#Full model
mod6 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1+dFactor|rat)+(1+cFactor|rat), data=df)
df$fit <- predict(mod6, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod6) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
mod6 <- lmer(rate ~ dFactor:ns(cFactor,3)+(1+dFactor|rat)+(1+cFactor|rat), data=df)
df$fit <- predict(mod6, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor:ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod6) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
source('~/GitHub/ratterdam/labMeetingLMERScript.R')
source('~/GitHub/ratterdam/labMeetingLMERScript.R')
# model 5
mod5 <- lmer(rate ~ dFactor*ns(cFactor,3)+(1+ns(cFactor,3)|rat)+ (1+dFactor|rat), data=df)
df$fit <- predict(mod5, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor*ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod5) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
# model 5
mod5 <- lmer(rate ~ dFactor:ns(cFactor,3)+(1+ns(cFactor,3)|rat)+ (1+dFactor|rat), data=df)
df$fit <- predict(mod5, newdata=df, re.form=NA)
Designmat <- model.matrix(rate ~ dFactor:ns(cFactor,3), df)
predvar <- diag(Designmat %*% vcov(mod5) %*% t(Designmat))
df$fitCI <- sqrt(predvar)*z
p <- ggplot(df, aes(x=cFactor, y=rate, color=as.factor(dFactor)))+
geom_line(aes(cFactor, fit))+
geom_ribbon(aes(y=fit, ymin=fit-fitCI, ymax=fit+fitCI, fill=as.factor(dFactor)), alpha=0.2)+
geom_point(size=2,alpha=0.5)
print(p)
source('~/GitHub/ratterdam/RatterdamOpen_Project/ratterdam_repetition_TimeDirLMER.R')
View(celldf)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_boxplot(position=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_boxplot(position=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_boxplot(position=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_boxplot(position=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_boxplot(position=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_boxplot(position=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_boxplot(position=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_boxplot(position=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_boxplot(position=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_boxplot(position=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_boxplot(position=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_boxplot(position=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_point(size=2,alpha=0.5,color=epoch)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
source('~/GitHub/ratterdam/RatterdamOpen_Project/ratterdam_repetition_TimeDirLMER.R')
View(celldf)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_point(size=2,alpha=0.5)+
geom_boxplot(group=epoch)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_point(size=2,alpha=0.5)+
geom_boxplot(aes(group=epoch))
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), color=epoch)+
geom_point(size=2,alpha=0.5)+
geom_boxplot(aes(group=histdir))
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate), fill=epoch)+
geom_point(size=2,alpha=0.5)+
geom_boxplot(aes(group=histdir))
print(p)
unique(celldf$epoch)
p <- ggplot(celldf, aes(x=histdir, y=rate), fill=epoch)+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate, color=epoch))+
geom_point(size=2,alpha=0.5)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate, color=epoch))+
geom_point(size=2,alpha=0.5)+
geom_boxplot(group=histdir)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate, color=epoch))+
geom_point(size=2,alpha=0.5)+
geom_bar(position=histdir, group=epoch)
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate, color=epoch))+
geom_point(size=2,alpha=0.5)+
geom_bar(aes(position=histdir, group=epoch))
print(p)
p <- ggplot(celldf, aes(x=histdir, y=rate, fill=epoch))+
geom_point(size=2,alpha=0.5)+
geom_bar()
print(p)
p <- ggplot(celldf, aes(x=histdir, y=fit, fill=epoch))+
geom_bar()
print(p)
p <- ggplot(celldf, aes(x=histdir, y=fit, fill=epoch))+
geom_bar(stat='identity')
print(p)
p <- ggplot(celldf, aes(x=histdir, y=fit, fill=epoch))+
geom_bar(position='dodge',stat='identity')
print(p)
p <- ggplot(celldf, aes(x=histdir, y=fit, fill=epoch))+
geom_bar(position='dodge',stat='identity')+
geom_errorbar(aes(ymin=fit-fitCI, ymax=fit+fitCI))
print(p)
p <- ggplot(celldf, aes(x=histdir, y=fit, fill=epoch))+
geom_bar(position='dodge',stat='identity')+
geom_errorbar(aes(ymin=fit-fitCI, ymax=fit+fitCI),position='dodge')
print(p)
p <- ggplot(celldf, aes(x=histdir, y=fit, fill=epoch))+
geom_bar(position='dodge',stat='identity')+
geom_errorbar(aes(ymin=fit-fitCI, ymax=fit+fitCI),position='dodge')+
ggtitle(sprintf("%s %s", exp, cellname))
print(p)
p <- ggplot(celldf, aes(x=histdir, y=fit, fill=epoch))+
facet_wrap(~field, nrow=3)+
geom_bar(position='dodge',stat='identity')+
geom_errorbar(aes(ymin=fit-fitCI, ymax=fit+fitCI),position='dodge')+
ggtitle(sprintf("%s %s", exp, cellname))
print(p)
source('~/GitHub/ratterdam/RatterdamOpen_Project/ratterdam_repetition_TimeDirLMER.R')
gettemp
source('~/GitHub/ratterdam/RatterdamOpen_Project/ratterdam_repetition_TimeDirLMER.R')
source('~/GitHub/ratterdam/RatterdamOpen_Project/ratterdam_repetition_TimeDirLMER.R')
source('~/GitHub/ratterdam/RatterdamOpen_Project/ratterdam_repetition_TimeDirLMER.R')
View(celldf)
savepath
title
gsub("\\","-",title)
gsub("\","-",title)
gsub("\\\\","-",title)
source('~/GitHub/ratterdam/RatterdamOpen_Project/ratterdam_repetition_TimeDirLMER.R')
source('~/GitHub/ratterdam/RatterdamOpen_Project/ratterdam_repetition_TimeDirLMER.R')
source("E:\\UserData\\Documents\\GitHub\\ratterdam\\Beltway_Project\\cicheck.R")
source("E:\\UserData\\Documents\\GitHub\\ratterdam\\Beltway_Project\\cicheck.R")
source('~/GitHub/ratterdam/Beltway_Project/ratterdam_beltway_shufflingLMER_2.R')
source('~/GitHub/ratterdam/Beltway_Project/ratterdam_beltway_shufflingLMER_2.R')
length(suffledData)
length(shuffledData)
sum(c(TRUE,TRUE,FALSE))
sum(shuffledData)
plot(shuffledData)
d
shuffledData
source('~/GitHub/ratterdam/Beltway_Project/ratterdam_beltway_shufflingLMER_2.R')
warnings()
shuffledData <- vector(mode='logical', length = nshuffles)
shuffledData
a <- TRUE
b <- FALSE
c <- FALSE
a||b
a||c
c||b
a||b||c
