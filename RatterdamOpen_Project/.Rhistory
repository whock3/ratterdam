m1r <- length(replr[replr<0.05])/length(replr)
m1n <- length(nonreplr[nonreplr<0.05])/length(nonreplr)
replr <- c()
repmse <- c()
repaic <- c()
nonreplr <- c()
nonrepmse <- c()
nonrepaic <- c()
oalleydf <- subset(alleydf, Orientation=='H')
for(fid in unique(oalleydf$FieldID)){
field <- subset(oalleydf, FieldID==fid)
x <- try({
gmod <- glm(Rate+1 ~ PrevDir + CurrDir + NextDir, data=field, family='Gamma')
gnull <- glm(Rate+1 ~ 1, family='Gamma', data=field)
},silent=TRUE)
if(class(x)!='try-error'){
if(unique(field$Repeating)=='True'){
replr <- c(replr, lrtest(gmod,gnull)[2,'Pr(>Chisq)'])
repmse <- c(repmse, sqrt(mean(gmod$residuals^2)))
repaic <- c(repaic, gmod$aic-gnull$aic)
}
else if(unique(field$Repeating)=='False'){
nonreplr <- c(nonreplr, lrtest(gmod,gnull)[2,'Pr(>Chisq)'])
nonrepmse <- c(nonrepmse, sqrt(mean(gmod$residuals^2)))
nonrepaic <- c(nonrepaic, gmod$aic - gnull$aic)
}
}
}
m2r <- length(replr[replr<0.05])/length(replr)
m2n <- length(nonreplr[nonreplr<0.05])/length(nonreplr)
boxplot(c(m1r, m1n, m2r, m2n), names=c("Vertical Repeat", "Vertical Nonrep", "Horizontal Repeat", "Horizontal Nonrep"))
barplot(c(m1r, m1n, m2r, m2n), names=c("Vertical Repeat", "Vertical Nonrep", "Horizontal Repeat", "Horizontal Nonrep"))
barplot(c(m1r, m1n, m2r, m2n), names=c("Vertical Repeat", "Vertical Nonrep", "Horizontal Repeat", "Horizontal Nonrep"),main="Proportion of Fields with effect of full model glm(P+C+N), Gamma family")
barplot(c(m1r, m1n, m2r, m2n), names=c("Vertical Repeat", "Vertical Nonrep", "Horizontal Repeat", "Horizontal Nonrep"),main="Proportion of Fields with effect of full model glm(Rate~P+C+N), Gamma family")
replr <- c()
repmse <- c()
repaic <- c()
nonreplr <- c()
nonrepmse <- c()
nonrepaic <- c()
oalleydf <- subset(alleydf, Orientation=='V')
for(fid in unique(oalleydf$FieldID)){
field <- subset(oalleydf, FieldID==fid)
x <- try({
gmod <- glm(Rate+1 ~ PrevDir + CurrDir + NextDir, data=field, family='Gamma')
gnull <- glm(Rate+1 ~ CurrDir, family='Gamma', data=field)
},silent=TRUE)
if(class(x)!='try-error'){
if(unique(field$Repeating)=='True'){
replr <- c(replr, lrtest(gmod,gnull)[2,'Pr(>Chisq)'])
repmse <- c(repmse, sqrt(mean(gmod$residuals^2)))
repaic <- c(repaic, gmod$aic-gnull$aic)
}
else if(unique(field$Repeating)=='False'){
nonreplr <- c(nonreplr, lrtest(gmod,gnull)[2,'Pr(>Chisq)'])
nonrepmse <- c(nonrepmse, sqrt(mean(gmod$residuals^2)))
nonrepaic <- c(nonrepaic, gmod$aic - gnull$aic)
}
}
}
m1r <- length(replr[replr<0.05])/length(replr)
m1n <- length(nonreplr[nonreplr<0.05])/length(nonreplr)
replr <- c()
repmse <- c()
repaic <- c()
nonreplr <- c()
nonrepmse <- c()
nonrepaic <- c()
oalleydf <- subset(alleydf, Orientation=='V')
for(fid in unique(oalleydf$FieldID)){
field <- subset(oalleydf, FieldID==fid)
x <- try({
gmod <- glm(Rate+1 ~ PrevDir + CurrDir + NextDir, data=field, family='Gamma')
gnull <- glm(Rate+1 ~ CurrDir, family='Gamma', data=field)
},silent=TRUE)
if(class(x)!='try-error'){
if(unique(field$Repeating)=='True'){
replr <- c(replr, lrtest(gmod,gnull)[2,'Pr(>Chisq)'])
repmse <- c(repmse, sqrt(mean(gmod$residuals^2)))
repaic <- c(repaic, gmod$aic-gnull$aic)
}
else if(unique(field$Repeating)=='False'){
nonreplr <- c(nonreplr, lrtest(gmod,gnull)[2,'Pr(>Chisq)'])
nonrepmse <- c(nonrepmse, sqrt(mean(gmod$residuals^2)))
nonrepaic <- c(nonrepaic, gmod$aic - gnull$aic)
}
}
}
m2r <- length(replr[replr<0.05])/length(replr)
m2n <- length(nonreplr[nonreplr<0.05])/length(nonreplr)
barplot(c(m1r, m1n, m2r, m2n), names=c("Vertical Repeat", "Vertical Nonrep", "Horizontal Repeat", "Horizontal Nonrep"),main="Proportion of Fields with effect of glm(Rate~P+C+N) versus glm(Rate~C), Gamma family")
barplot(c(m1r, m1n, m2r, m2n), names=c("Vertical Repeat", "Vertical Nonrep", "Horizontal Repeat", "Horizontal Nonrep"),main="Proportion of Fields with LRT effect of glm(Rate~P+C+N) versus glm(Rate~C), Gamma family")
replr <- c()
repmse <- c()
repaic <- c()
nonreplr <- c()
nonrepmse <- c()
nonrepaic <- c()
oalleydf <- subset(alleydf, Orientation=='H')
for(fid in unique(oalleydf$FieldID)){
field <- subset(oalleydf, FieldID==fid)
x <- try({
gmod <- glm(Rate+1 ~ PrevDir + CurrDir + NextDir, data=field, family='Gamma')
gnull <- glm(Rate+1 ~ CurrDir, family='Gamma', data=field)
},silent=TRUE)
if(class(x)!='try-error'){
if(unique(field$Repeating)=='True'){
replr <- c(replr, lrtest(gmod,gnull)[2,'Pr(>Chisq)'])
repmse <- c(repmse, sqrt(mean(gmod$residuals^2)))
repaic <- c(repaic, gmod$aic-gnull$aic)
}
else if(unique(field$Repeating)=='False'){
nonreplr <- c(nonreplr, lrtest(gmod,gnull)[2,'Pr(>Chisq)'])
nonrepmse <- c(nonrepmse, sqrt(mean(gmod$residuals^2)))
nonrepaic <- c(nonrepaic, gmod$aic - gnull$aic)
}
}
}
m2r <- length(replr[replr<0.05])/length(replr)
m2n <- length(nonreplr[nonreplr<0.05])/length(nonreplr)
barplot(c(m1r, m1n, m2r, m2n), names=c("Vertical Repeat", "Vertical Nonrep", "Horizontal Repeat", "Horizontal Nonrep"),main="Proportion of Fields with LRT effect of glm(Rate~P+C+N) versus glm(Rate~C), Gamma family")
replr <- c()
repmse <- c()
repaic <- c()
nonreplr <- c()
nonrepmse <- c()
nonrepaic <- c()
oalleydf <- subset(alleydf, Orientation=='V')
for(fid in unique(oalleydf$FieldID)){
field <- subset(oalleydf, FieldID==fid)
x <- try({
gmod <- glm(Rate+1 ~ PrevDir + CurrDir + NextDir, data=field, family='Gamma')
gnull <- glm(Rate+1 ~ CurrDir, family='Gamma', data=field)
},silent=TRUE)
if(class(x)!='try-error'){
if(unique(field$Repeating)=='True'){
replr <- c(replr, lrtest(gmod,gnull)[2,'Pr(>Chisq)'])
repmse <- c(repmse, sqrt(mean(gmod$residuals^2)))
repaic <- c(repaic, gmod$aic-gnull$aic)
}
else if(unique(field$Repeating)=='False'){
nonreplr <- c(nonreplr, lrtest(gmod,gnull)[2,'Pr(>Chisq)'])
nonrepmse <- c(nonrepmse, sqrt(mean(gmod$residuals^2)))
nonrepaic <- c(nonrepaic, gmod$aic - gnull$aic)
}
}
}
# m2r <- length(replr[replr<0.05])/length(replr)
# m2n <- length(nonreplr[nonreplr<0.05])/length(nonreplr)
m1r <- repaic
m1n <- nonrepaic
replr <- c()
repmse <- c()
repaic <- c()
nonreplr <- c()
nonrepmse <- c()
nonrepaic <- c()
oalleydf <- subset(alleydf, Orientation=='H')
for(fid in unique(oalleydf$FieldID)){
field <- subset(oalleydf, FieldID==fid)
x <- try({
gmod <- glm(Rate+1 ~ PrevDir + CurrDir + NextDir, data=field, family='Gamma')
gnull <- glm(Rate+1 ~ CurrDir, family='Gamma', data=field)
},silent=TRUE)
if(class(x)!='try-error'){
if(unique(field$Repeating)=='True'){
replr <- c(replr, lrtest(gmod,gnull)[2,'Pr(>Chisq)'])
repmse <- c(repmse, sqrt(mean(gmod$residuals^2)))
repaic <- c(repaic, gmod$aic-gnull$aic)
}
else if(unique(field$Repeating)=='False'){
nonreplr <- c(nonreplr, lrtest(gmod,gnull)[2,'Pr(>Chisq)'])
nonrepmse <- c(nonrepmse, sqrt(mean(gmod$residuals^2)))
nonrepaic <- c(nonrepaic, gmod$aic - gnull$aic)
}
}
}
# m2r <- length(replr[replr<0.05])/length(replr)
# m2n <- length(nonreplr[nonreplr<0.05])/length(nonreplr)
m2r <- repaic
m2n <- nonrepaic
boxplot(c(m1r, m1n, m2r, m2n), names=c("Vertical Repeat", "Vertical Nonrep", "Horizontal Repeat", "Horizontal Nonrep"))
boxplot(m1r, m1n, m2r, m2n, names=c("Vertical Repeat", "Vertical Nonrep", "Horizontal Repeat", "Horizontal Nonrep"))
pwd
ls
getwd()
setwd("E:\UserData\\Documents\\GitHub\\ratterdam\RatterdamOpen_Project\\")
setwd("E:\\UserData\\Documents\\GitHub\\ratterdam\RatterdamOpen_Project\\")
setwd("E:\\UserData\\Documents\\GitHub\\ratterdam\\RatterdamOpen_Project\\")
getwd()
field
library(lmtest)
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
oriendf <- subset(alleydf, Orientation=='V')
nrow(alleydf)
nrow(oriendf)
field <- subset(oriendf, FieldID ==0)
field
field <- subset(oriendf, FieldID ==1)
field
field <- subset(oriendf, FieldID ==2)
field
unique(oriendf$FieldID)
field <- subset(oriendf, FieldID ==4)
field
m1 <- glm(Rate~1, data=field, family='gamma')
m1 <- glm(Rate~1, data=field, family='Gamma')
m1 <- glm(Rate+1~1, data=field, family='Gamma')
m2 <- glm(Rate+1 ~ CurrDir, data=field, family='Gamma')
m3 <- glm(Rate+1 ~ PrevDir + CurrDir + NextDir, data = field, family='Gamma')
lrtest(m1,m2,m3)
lrtest(m1,m2)
lrtest(m1,m3)
lrtest(m2,m3)
t <- lrtest(m1,m2,m3)
t[2,"Pr(>Chisq)"]
t[3,"Pr(>Chisq)"]
t[1,"Pr(>Chisq)"]
m2
m3
unique(field$Repeating)
unique(field$Repeating)[1]
unique(field$Repeating)[1][1]
unique(field$Repeating)=='True'
m3$aic
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
traceback()
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
length(nonrepAIC)
length(repAIC)
repN
nonrepN
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
traceback()
length(repAIC)
fid
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
fid
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
length(unique(oriendf$FieldID))
actualRun
repN
nonrepN
hist(repAIC)
hist(nonrepAIC)
wilcox.test(repAIC, nonrepAIC)
ks.test(repAIC,nonrepAIC)
mean(nonrepAIC)
mean(repAIC)
barplot(mean(repAIC),mean(nonrepAIC))
barplot(c(mean(nonrepAIC),mean(repAIC))
barplot(c(mean(nonrepAIC),mean(repAIC)))
boxplot(c(repAIC, nonrepAIC))
boxplot(repAIC, nonrepAIC)
boxplot(repAIC, nonrepAIC,ylim=c(0,300))
boxplot(repAIC, nonrepAIC)
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
msigCD
repN
nonrepN
binom.test(23,76,p=0.05,alternative='greater')
binom.test(10,76,p=0.05,alternative='greater')
lrt
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
hist(repAIC)
hist(nonrepAIC)
repAIC
repAIC[repAIC<0]
nonrepAIC[nonrepAIC<0]
repAIC[repAIC<0]/length(repAIC)
length(repAIC[repAIC<0])/length(repAIC)
length(nonrepAIC[nonrepAIC<0])/length(nonrepAIC)
length(repAIC)
length(nonrepAIC)
msigCD
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
msigCD
length(unique(oriendf$FieldID))
76/151
length(repAIC)
length(nonrepAIC)
repN
nonrepN
mean(repAIC)
mean(nonrepAIC)
hist(repAIC)
hist(nonrepAIC)
wilcox.test(repAIC,nonrepAIC)
hist(repAIC,freq=FALSE)
hist(nonrepAIC,freq=FALSE,add=TRUE,col=rgb(1,0,0,0.5))
length(unique(oriendf$FieldID))
10/151
23/151
actualRun
10/144
23/144
length(repAIC)
23/55
length(nonrepAIC)
10/21
nrow(subset(oriendf, Repeating=='True'))
length(unique(oriendf[oriendf$Repeating=='True']$FieldID))
length(unique(oriendf[oriendf$Repeating=='True',]$FieldID))
length(unique(oriendf[oriendf$Repeating=='False',]$FieldID))
23/111
10/40
repN
nonrepN
length(repAIC)
55/111
length(nonrepAIC)
21/40
actualRun
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
actualRunRep
actualRunNonrep
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
actualRunRep
actualRunNonrep
length(repAIC)
55/106
length(nonrepAIC)
21/55
msigCD
21/38
55/106
21/38
repN
nonrepN
10/38
23/106
binom.test(10,38,p=0.05,alternative='greater')
binom.test(23,106,p=0.05,alternative='greater')
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
actualRunRep
actualRunNonrep
repN
nonrepN
msigCD
length(repAIC)
length(nonrepAIC)
24/54
11/20
9/54
4/20
binom.test(4,20,p=0.05,alternative='greater')
binom.test(9,54,p=0.05,alternative='greater')
9/.35
9/24
4/11
4/.3
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
actualRunRep
actualRunNonrep
length(repAIC)
length(nonrepAIC)
34/59
10/21
repN
nonrepN
13/59
13/34
6/21
6/10
mod <- glmer(Rate+1 ~ PrevDir+CurrDir+NextDir+(PrevDir|FieldID)+(CurrDir|FieldID)+(NextDir|FieldID),family='Gamma'
mod <- glmer(Rate+1 ~ PrevDir+CurrDir+NextDir+(PrevDir|FieldID)+(CurrDir|FieldID)+(NextDir|FieldID),family='Gamma',data=oriendf)
mod <- glmer(Rate+1 ~ PrevDir+CurrDir+NextDir+(PrevDir|FieldID)+(CurrDir|FieldID)+(NextDir|FieldID),family='Gamma',data=oriendf,maxit=1000)
mod <- glmer(Rate+1 ~ PrevDir+CurrDir+NextDir+(PrevDir|FieldID)+(CurrDir|FieldID)+(NextDir|FieldID),family='Gamma',data=oriendf)
summary(mod)
mod <- glmer(Rate+1 ~ PrevDir+CurrDir+NextDir+(PrevDir|FieldID)+(CurrDir|FieldID)+(NextDir|FieldID),family='Gamma',data=oriendf,link='log')
mod <- glmer(Rate+1 ~ PrevDir+CurrDir+NextDir+(PrevDir|FieldID)+(CurrDir|FieldID)+(NextDir|FieldID),family='Gamma(link="log")',data=oriendf)
mod <- glmer(Rate+1 ~ PrevDir+CurrDir+NextDir+(PrevDir|FieldID)+(CurrDir|FieldID)+(NextDir|FieldID),family=gamma(link="log"),data=oriendf)
mod <- glmer(Rate+1 ~ PrevDir+CurrDir+NextDir+(PrevDir|FieldID)+(CurrDir|FieldID)+(NextDir|FieldID),family=Gamma(link="log"),data=oriendf)
summary(mod)
m1 <- glm(Rate+1 ~ 1, family='Gamma', data=field)
m1
summary(m1)
m1 <- glm(Rate+1 ~ 1, family=Gamma(), data=field)
m1 <- glm(Rate+1 ~ 1, family=Gamma(), data=field)
summary(m1)
field
m1 <- glm(Rate+1 ~ 1, family='Gamma', data=field)
m2 <- glm(Rate+1 ~ CurrDir, family = 'Gamma', data=field)
m3 <- glm(Rate+1 ~ PrevDir + CurrDir + NextDir, family='Gamma',data=field)
lrtest(m1,m2,m3)
anova(m1,m2,test='Chisq')
anova(m1,m3,test='Chisq')
anova(m2,m3,test='Chisq')
hist(field$Rate)
hist(field$Rate,breaks=20)
library(MCMCglmm)
m4 <- MCMCglmm(Rate+1 ~ CurrDir + PrevDir + NextDir, family='Gamma',data=field)
m4 <- MCMCglmm(Rate+1 ~ CurrDir + PrevDir + NextDir, family='gamma',data=field)
m4 <- MCMCglmm(Rate+1 ~ CurrDir + PrevDir + NextDir, family='gaussian',data=field)
summary(m4)
anova(m4)
m4$VCV
m4$Residual
field
m1 <- glm(Rate+1 ~ 1, family='Gamma', data=field)
m2 <- glm(Rate+1 ~ CurrDir, family = 'Gamma', data=field)
m3 <- glm(Rate+1 ~ PrevDir + CurrDir + NextDir, family='Gamma',data=field)
m4 <- glm(Rate+1 ~ PrevDir + CurrDir, family='Gamma', data=field)
m5 <- glm(Rate+1 ~ CurrDir + NextDir, family='Gamma', data=field)
lrtest(m1,m2,m3,m4,m5)
lrtest(m1, m2)
lrtest(m2,m3)
lrtest(m2,m4)
lrtest(m2,m5)
lrtest(m4,m5)
summary(m3)
aov(m3)
anova(m3)
lrtest(m1,m2)
sqrt(mean(m1$resdiuals^2))
mean(m1$resdiuals^2)
m1$residuals
m1$residuals^2
mean(m1$residuals^2)
mean(m2$residuals^2)
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
repN/actualRunRep
nonrepN/actualRunNonrep
length(repAIC)/actualRunRep
length(nonrepAIC)/actualRunNonrep
repN/length(repAIC)
nonrepN/length(nonrepAIC)
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
repN/actualRunRep
nonrepN/actualRunNonrep
length(repAIC)/actualRunRep
length(nonrepAIC)/actualRunNonrep
repN/length(repAIC)
nonrepN/length(nonrepAIC)
nonrepN
repN
actualRunRep
actualRunNonrep
14/74
field
m1
m2
m3
m4 <- glm(Rate+1 ~ CurrDir + PrevDir, family='Gamma', data=field)
m5 <- glm(Rate+1 ~ CurrDir + NextDir, family='Gamma', data=field)
lrtest(m1,m2)
lrtest(m2,m4)
lrtest(m2,m5)
lrtest(m2,m3)
lrtest(m1,m2)
l <- lrtest(m1,m2)
l[2,"Pr(>Chisq)"]
lrtest(m1,m2)[2,"Pr(>Chisq)"]
field
lrt <- lrtest(m1,m2,m3,m4,m5)
lrt
lrtest(m1,m2)
lrtest(m2,m3)
lrtest(m3,m4)
lrtest(m4,m5)
lrtest(m1,m3)
lrtest(m1,m2)
lrtest(m1,m4)
lrtest(m1,m2)
lrtest(m2,m3)
lrtest(m2,m4)
lrtest(m2,m5)
lrtest(m3,m5)
lrtest(m4,m5)
m1 <- glm(Rate+1 ~ 1, family='Gamma', data=field)
m2 <- glm(Rate+1 ~ CurrDir, family = 'Gamma', data=field)
m3 <- glm(Rate+1 ~ PrevDir + CurrDir, family='Gamma',data=field)
m4 <- glm(Rate+1 ~ CurrDir + NextDir, family='Gamma',data=field)
m5 <- glm(Rate+1 ~ PrevDir + CurrDir + NextDir, family='Gamma',data=field)
lrtest(m1,m2)
lrtest(m2,m3)
lrtest(m2,m4)
lrtest(m3,m5)
lrtest(m4,m5)
nonrepCD <- nonrepCD + 1
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
repFull
nonrepFull
repCD
actualRunRep
actualRunNonrep
repPD
nonrepPD
repND
nonrepND
nonrepCD
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
repPD
repND
nonrepPD
nonrepND
sprintf("Repeating fields best model is P+C+N: %s",repFull/actualRunRep)
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
sprintf("%s Alleys",o)
sprintf("Repeating fields best model is P+C+N: %s",repFull/actualRunRep)
sprintf("Repeating fields best mode is Current Dir: %s",repCD/actualRunRep)
sprintf("Repeating fields best model is Previous Dir: %s",repPD/actualRunRep)
sprintf("Repeating fields best model is Next Dir: %s",repND/actualRunRep)
sprintf("Non-repeating fields best model is P+C+N: %s",nonrepFull/actualRunNonrep)
sprintf("Non-repeating fields best mode is Current Dir: %s",nonrepCD/actualRunNonrep)
sprintf("Non-repeating fields best model is Previous Dir: %s",nonrepPD/actualRunNonrep)
sprintf("Non-repeating fields best model is Next Dir: %s",nonrepND/actualRunNonrep)
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
closeAllConnections()
source('~/GitHub/ratterdam/RatterdamOpen_Project/repetition_GLM_ModelComparison.R')
